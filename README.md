Most of the heavy lifting was done by Brett Terpstra
http://goo.gl/jo469J
